<!DOCTYPE html>
<html>
	<head>
		<title>testing dom-attr</title>
		<script src="../dojo.js" data-dojo-config="isDebug:true"></script>
		<script>
			require(["dojo", "doh", "dojo/dom-attr", "dojo/dom", "dojo/domReady!"], function(dojo, doh, domAttr, dom){
				doh.register([
					{
						name: "set / get Attribute",
						runTest: function(t){
							var node = dom.byId("node"),
								content = domAttr.get(dom.byId("lorem"), "textContent"),
								content2 = domAttr.get(dom.byId("example"), "textContent");
							node.innerHTML = "" //empty the node before testing
							
							doh.is(true, content != null); //test is getter works
							doh.is("Etiam", content.substr(0, 5)); //test if getters return the expected value
							
							domAttr.set(node, "textContent", content);
							doh.is(content, node.innerHTML); //test is setter works (no text transformation exepcted because it's just a simple word)
							
							domAttr.set(node, "textContent", "<b>this is bold</b>");
							doh.is(-1, node.innerHTML.indexOf("<")); //test if setter escape properly the content
							
							domAttr.set(node, "textContent", content2);
							
							var test = node.innerHTML.replace(/\n/g, "");
							doh.is(-1, test.indexOf("(comment)")); //test if html comments are ignored
						}
					}
				]);

				doh.run();
			});
		</script>
	</head>
	<body>
	<div id="lorem">Etiam</div>
	<div id="example">
		<!-- <p>This should not show (comment).</p>-->
	</div>
	<pre id="node"></pre>
	</body>
</html>
